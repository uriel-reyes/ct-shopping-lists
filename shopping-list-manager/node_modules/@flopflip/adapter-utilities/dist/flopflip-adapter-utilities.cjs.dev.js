'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var kebabCase = require('lodash/kebabCase');
var getGlobalThis = require('globalthis');
var camelCase = require('lodash/camelCase');
var _slicedToArray = require('@babel/runtime/helpers/slicedToArray');

function _interopDefault (e) { return e && e.__esModule ? e : { 'default': e }; }

var kebabCase__default = /*#__PURE__*/_interopDefault(kebabCase);
var getGlobalThis__default = /*#__PURE__*/_interopDefault(getGlobalThis);
var camelCase__default = /*#__PURE__*/_interopDefault(camelCase);

const denormalizeFlagName = flagName => kebabCase__default["default"](flagName);

const exposeGlobally = adapter => {
  const globalThis = getGlobalThis__default["default"]();
  if (!globalThis.__flopflip__) {
    globalThis.__flopflip__ = {};
  }
  globalThis.__flopflip__[adapter.id] = adapter;
};

const normalizeFlag = (flagName, flagValue) => [camelCase__default["default"](flagName),
// Multi variate flags contain a string or `null` - `false` seems more natural.
// eslint-disable-next-line no-eq-null, eqeqeq, @typescript-eslint/prefer-nullish-coalescing
flagValue == null ? false : flagValue];

const normalizeFlags = function (rawFlags) {
  let normalizeFlag$1 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : normalizeFlag;
  return Object.entries(rawFlags || {}).reduce((normalizedFlags, _ref) => {
    let _ref2 = _slicedToArray(_ref, 2),
      flagName = _ref2[0],
      flagValue = _ref2[1];
    const _normalizeFlag = normalizeFlag$1(flagName, flagValue),
      _normalizeFlag2 = _slicedToArray(_normalizeFlag, 2),
      normalizedFlagName = _normalizeFlag2[0],
      normalizedFlagValue = _normalizeFlag2[1];
    // Can't return expression as it is the assigned value
    normalizedFlags[normalizedFlagName] = normalizedFlagValue;
    return normalizedFlags;
  }, {});
};

exports.denormalizeFlagName = denormalizeFlagName;
exports.exposeGlobally = exposeGlobally;
exports.normalizeFlag = normalizeFlag;
exports.normalizeFlags = normalizeFlags;
