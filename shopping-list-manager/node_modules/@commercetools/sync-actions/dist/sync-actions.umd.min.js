!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("lodash.flatten"),require("lodash.isequal"),require("lodash.isnil"),require("lodash.foreach"),require("lodash.uniqwith"),require("lodash.intersection"),require("lodash.without"),require("lodash.sortby")):"function"==typeof define&&define.amd?define(["exports","lodash.flatten","lodash.isequal","lodash.isnil","lodash.foreach","lodash.uniqwith","lodash.intersection","lodash.without","lodash.sortby"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).CommercetoolsSyncActions={},t.flatten,t.isEqual,t.isNil,t.forEach,t.uniqWith,t.intersection,t.without,t.sortBy)}(this,function(t,V,M,K,F,L,U,q,H){"use strict";function e(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var v=e(V),B=e(M),f=e(K),g=e(F),$=e(L),_=e(U),G=e(q),Z=e(H);function W(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach(function(t){k(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J(t,e){if(null==t)return{};var n,i=function(t,e){if(null==t)return{};for(var n,i={},r=Object.keys(t),a=0;a<r.length;a++)n=r[a],0<=e.indexOf(n)||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(t),a=0;a<r.length;a++)n=r[a],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n]);return i}function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a=[],o=!0,u=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(a.push(i.value),!e||a.length!==e);o=!0);}catch(t){u=!0,r=t}finally{try{o||null==n.return||n.return()}finally{if(u)throw r}}return a}}(t,e)||Q(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Q(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(t,e){var n;if(t)return"string"==typeof t?i(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var X=["prices"];function Y(t){return{value:{currencyCode:t.value.currencyCode},channel:t.channel,country:t.country,customerGroup:t.customerGroup,validFrom:t.validFrom,validUntil:t.validUntil}}function tt(n,t){return t&&t.prices.find(function(t){return e=n,t=Y(t=t),e=Y(n),B.default(e,t);var e})||null}function n(a,o,u,t){var c=3<arguments.length&&void 0!==t?t:{};return function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!t||!e)throw new Error("Missing either `newObj` or `oldObj` in order to build update actions");e=e,t=t;var r,i=y((i=u)&&"function"==typeof i?i(e,t):[e,t],2),e=i[0],t=i[1],i=(t.variants&&e.variants&&(t.variants=(i=t.variants,r=e.variants,i.map(function(e){var n,t=e.prices,i=J(e,X);return t?(n=r.find(function(t){return!f.default(t.id)&&t.id===e.id||!f.default(t.key)&&t.key===e.key||!f.default(t.sku)&&t.sku===e.sku}),p(p({},i),{},{prices:t.map(function(t){var e=p({},t),t=tt(t,n);return t&&(e.id||(e.id=t.id),f.default(e.value.type)&&(e.value.type=t.value.type),f.default(e.value.fractionDigits)&&(e.value.fractionDigits=t.value.fractionDigits)),e})})):i}))),a(e,t));return c.withHints||i?o(i,t,e,n):[]}}function r(t){var i=0<arguments.length&&void 0!==t?t:[];return function(e,t){if(!Object.keys(i).length)return t();var n=i.find(function(t){return t.type===e});if(!n)return[];if("ignore"===n.group||"black"===n.group)return[];if("allow"===n.group||"white"===n.group)return t();throw new Error("Action group '".concat(n.group,'\' not supported. Use either "allow" or "ignore".'))}}var et=new(require("jsondiffpatch").DiffPatcher)({objectHash:function(t,e){return e="$$index:".concat(e),"object"===b(t)&&null!==t&&(t.id||t.name||t.url)||e},arrays:{detectMove:!0,includeValueOnMove:!1},textDiff:{minLength:Number.MAX_SAFE_INTEGER}});function a(t,e){return et.diff(t,e)}function h(t,e){return et.patch(t,e)}function A(t,e){if(!Array.isArray(t))throw new Error("Expected array to extract delta value");if(1===t.length)return t[0];if(2===t.length)return t[1];if(3!==t.length||0!==t[2]){if(3===t.length&&2===t[2]){if(e)return h(e,t);throw new Error("Cannot apply patch to long text diff. Missing original object.")}if(3===t.length&&3===t[2])throw new Error("Detected an array move, it should not happen as `includeValueOnMove` should be set to false");throw new Error("Got unsupported number ".concat(t[2]," in delta value"))}}function nt(t){return Array.isArray(t.custom)}function it(t){return Boolean(t.custom.fields)}function rt(t){return Boolean(t.custom.type)}function at(t,e){return Array.isArray(t.custom.type)?A(t.custom.type,e):t.custom.type}function ot(t,e){return Array.isArray(t.id)?A(t.id):e.custom.type.id}function ut(t,e){return Array.isArray(t.key)?A(t.key):e.custom.type.key}function ct(t,e){return Array.isArray(t)?A(t):e}function st(t,e){return t[e]}var dt=["actions"],lt={setCustomType:"setCustomType",setCustomField:"setCustomField"};function m(t,e,n,i){var i=3<arguments.length&&void 0!==i?i:{actions:{}},r=[],a=i.actions,o=J(i,dt),u=p(p({},lt),a);return t.custom&&(nt(t)?(i=A(t.custom,n),r.push(p(p({action:u.setCustomType},o),i))):rt(t)?(a=at(t,n))?a.id?r.push(p(p({action:u.setCustomType},o),{},{type:{typeId:"type",id:ot(a,e)},fields:ct(t.custom.fields,e.custom.fields)})):a.key&&r.push(p(p({action:u.setCustomType},o),{},{type:{typeId:"type",key:ut(a,e)},fields:ct(t.custom.fields,e.custom.fields)})):r.push(p({action:u.setCustomType},o)):it(t)&&(i=Object.keys(t.custom.fields).map(function(t){return p(p({action:u.setCustomField},o),{},{name:t,value:st(e.custom.fields,t)})}),r.push.apply(r,O(i)))),r}var ft=new RegExp(/^\d+$/),pt=new RegExp(/^_\d+$/),j="create",S="remove",w="change";function I(l,f){return function(t,a,o){var u,c=[],s=[],d=[];return t[l]&&(u=t[l],Object.keys(u).forEach(function(t){var e,n,i,r;f[j]&&(i=u,r=t,ft.test(r)&&Array.isArray(i[r])&&1===i[r].length)?(i=(0,f[j])(o[l][t],parseInt(t,10)))&&c.push(i):f[w]&&(r=u,i=t,ft.test(i)&&("object"===b(r[i])||"string"==typeof r[i]))?(e=(0,f[w])(a[l][t],o[l][t],parseInt(t,10)))&&d.push(e):f[S]&&(e=u,n=t,pt.test(n)&&Array.isArray(e[n])&&3===e[n].length&&("object"===b(e[n][0])||"string"==typeof e[n][0])&&0===e[n][1]&&0===e[n][2])&&(n=t.replace("_",""),(t=(0,f[S])(a[l][n],parseInt(n,10)))&&s.push(t))})),d.concat(s,c)}}function yt(t){return t.id?{assetId:t.id}:{assetKey:t.key}}function ht(t){return JSON.parse(JSON.stringify(t))}function u(t){return function(e){return t.some(function(t){return t===("string"==typeof(t=e)?t.trim():t)})}}function E(t){var e=t.actions,c=t.diff,s=t.oldObj,d=t.newObj,t=t.shouldOmitEmptyString,l=u(t?[void 0,null,""]:[void 0,null]);return e.map(function(t){var e=t.key,n=t.actionKey||t.key,i=c[e],r=s[e],a=d[e],o=l(s[e]),u=l(d[e]);if(i&&(!u||!o))return!u&&o?k({action:t.action},n,a):!u||{}.hasOwnProperty.call(d,e)?u&&{}.hasOwnProperty.call(d,e)?{action:t.action}:(o=h(ht(r),i),k({action:t.action},n,o)):void 0}).filter(function(t){return!f.default(t)})}function l(t){var e=t.actions,i=t.diff,r=t.newObj;return e.map(function(t){var e,n=t.action,t=t.key;if(i[t]&&(Array.isArray(i[t])||i[t].id))return(e=Array.isArray(i[t])?A(i[t]):r[t])?e.id?k({action:n},t,{typeId:e.typeId,id:e.id}):k({action:n},t,{typeId:e.typeId,key:e.key}):{action:n}}).filter(function(t){return t})}var mt=[{action:"changeName",key:"name"},{action:"changeSlug",key:"slug"},{action:"setDescription",key:"description"},{action:"changeOrderHint",key:"orderHint"},{action:"setExternalId",key:"externalId"},{action:"setKey",key:"key"}],vt=[{action:"setMetaTitle",key:"metaTitle"},{action:"setMetaKeywords",key:"metaKeywords"},{action:"setMetaDescription",key:"metaDescription"}],gt=[{action:"changeParent",key:"parent"}];var bt="custom";function c(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return f.default(t)||f.default(o)?[t,o]:[t,Object.entries(t).reduce(function(t,e){var e=y(e,2),n=e[0],e=e[1];if(n!==bt)if(Array.isArray(e)&&o[n]&&1<=o[n].length)for(var i,r=e.reduce(function(t,e){return t[e.id]=e,t},{}),a=0;a<o[n].length;a++)f.default(o[n][a])||"object"!==b(o[n][a])||f.default(o[n][a].id)||(i=r[o[n][a].id],f.default(i)||(i=y(c(i,o[n][a]),2)[1],Object.isFrozen(t[n])&&(t[n]=t[n].slice()),t[n][a]=i));else Array.isArray(e)?t[n]=f.default(o[n])?[]:o[n]:f.default(o[n])||"object"!==b(e)||e instanceof Date||(e=y(c(e,o[n]),2)[1],t[n]=e);return t},p({},o))]}function kt(e,n){return function(r,a,o){var t=[];return t.push(e("base",function(){return function(t,e,n,i){return E({actions:mt,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(r,o,a,n)})),t.push(e("references",function(){return l({actions:gt,diff:r,oldObj:o,newObj:a})})),t.push(e("meta",function(){return E({actions:vt,diff:r,oldObj:o,newObj:a})})),t.push(e("custom",function(){return m(r,a,o)})),t.push(e("assets",function(){return t=r,e=o,n=a,I("assets",(k(i={},j,function(t){return{action:"addAsset",asset:t}}),k(i,S,function(t){return p({action:"removeAsset"},yt(t))}),k(i,w,function(t,e){return[p({action:"removeAsset"},yt(t)),{action:"addAsset",asset:e}]}),i))(t,e,n);var t,e,n,i})),v.default(t)}}var Ot=u([void 0,null,""]),At=[{action:"setSalutation",key:"salutation"},{action:"changeEmail",key:"email"},{action:"setFirstName",key:"firstName"},{action:"setLastName",key:"lastName"},{action:"setMiddleName",key:"middleName"},{action:"setTitle",key:"title"},{action:"setCustomerNumber",key:"customerNumber"},{action:"setExternalId",key:"externalId"},{action:"setCompanyName",key:"companyName"},{action:"setDateOfBirth",key:"dateOfBirth"},{action:"setLocale",key:"locale"},{action:"setVatId",key:"vatId"},{action:"setStores",key:"stores"},{action:"setKey",key:"key"}],jt=[{action:"setDefaultBillingAddress",key:"defaultBillingAddressId",actionKey:"addressId"},{action:"setDefaultShippingAddress",key:"defaultShippingAddressId",actionKey:"addressId"}],St=[{action:"setCustomerGroup",key:"customerGroup"}],wt=[{action:"setAuthenticationMode",key:"authenticationMode",value:"password"}];function It(t,e,n){return e=(t={actions:wt,diff:t,oldObj:e,newObj:n}).actions,c=t.diff,s=t.oldObj,d=t.newObj,e.map(function(t){var e=t.key,n=t.value||t.key,i=c[e],r=s[e],a=d[e],o=Ot(s[e]),u=Ot(d[e]);if(i&&(!u||!o)){if("Password"===d.authenticationMode&&!d.password)throw new Error("Cannot set to Password authentication mode without password");if("authenticationMode"in d&&!["Password","ExternalAuth"].includes(d.authenticationMode))throw new Error("Invalid Authentication Mode");if(!u&&o)return"ExternalAuth"===d.authenticationMode?{action:t.action,authMode:a}:k({action:t.action,authMode:a},n,d.password);if(!u||{}.hasOwnProperty.call(d,e))if(!u||!{}.hasOwnProperty.call(d,e))return o=h(ht(r),i),"ExternalAuth"===d.authenticationMode?{action:t.action,authMode:o}:k({action:t.action,authMode:o},n,d.password)}}).filter(function(t){return!f.default(t)});var c,s,d}function Et(e,n){return function(r,a,o){var t=[];return t.push(e("base",function(){return function(t,e,n,i){return E({actions:At,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(r,o,a,n)})),t.push(e("references",function(){return l({actions:St,diff:r,oldObj:o,newObj:a})})),t.push(e("addresses",function(){return t=r,e=o,n=a,I("addresses",(k(i={},j,function(t){return{action:"addAddress",address:t}}),k(i,S,function(t){return{action:"removeAddress",addressId:t.id}}),k(i,w,function(t,e){return{action:"changeAddress",addressId:t.id,address:e}}),i))(t,e,n);var t,e,n,i})),t.push(e("base",function(){return function(t,e,n,i){return E({actions:jt,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(r,o,a,n)})),t.push(e("billingAddressIds",function(){return t=r,e=o,n=a,I("billingAddressIds",(k(i={},j,function(t){return{action:"addBillingAddressId",addressId:t}}),k(i,S,function(t){return{action:"removeBillingAddressId",addressId:t}}),i))(t,e,n);var t,e,n,i})),t.push(e("shippingAddressIds",function(){return t=r,e=o,n=a,I("shippingAddressIds",(k(i={},j,function(t){return{action:"addShippingAddressId",addressId:t}}),k(i,S,function(t){return{action:"removeShippingAddressId",addressId:t}}),i))(t,e,n);var t,e,n,i})),t.push(e("custom",function(){return m(r,a,o)})),t.push(e("authenticationModes",function(){return It(r,o,a)})),v.default(t)}}var Nt=[{action:"changeQuantity",key:"quantityOnStock",actionKey:"quantity"},{action:"setRestockableInDays",key:"restockableInDays"},{action:"setExpectedDelivery",key:"expectedDelivery"}],Dt=[{action:"setSupplyChannel",key:"supplyChannel"}];function xt(r,a){return function(t,e,n){var i=[];return i.push(r("base",function(){return function(t,e,n,i){return E({actions:Nt,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(t,n,e,a)})),i.push(r("references",function(){return l({actions:Dt,diff:t,oldObj:n,newObj:e})})),i.push(r("custom",function(){return m(t,e,n)})),v.default(i)}}function N(t,e,n,i){var r,a,o;return t[e]&&(r=t[e][0],t=t[e][1],n&&n[r]&&(a=n[r]),i&&i[t]&&(o=i[t])),{oldObj:a,newObj:o}}var Ct=new RegExp(/^\d+$/),Pt=new RegExp(/^_\d+$/);function Rt(t,e){var t=0<arguments.length&&void 0!==t?t:[],i=1<arguments.length&&void 0!==e?e:"id";return t.reduce(function(t,e,n){return t.refByIndex[String(n)]=e[i],t.refByIdentifier[e[i]]=String(n),t},{refByIndex:{},refByIdentifier:{}})}function D(t,e,n,i){var e=1<arguments.length&&void 0!==e?e:[],n=2<arguments.length&&void 0!==n?n:[],i=3<arguments.length&&void 0!==i?i:"id",r={},e=Rt(e,i),a=e.refByIdentifier,o=e.refByIndex,e=Rt(n,i),u=e.refByIdentifier,c=e.refByIndex;return g.default(t,function(t,e){var n,i;Ct.test(e)?(n=c[e],r[e]=[a[n],e]):Pt.test(e)&&(n=e.substring(1),i=o[n],r[e]=[n,u[i]])}),r}function zt(t,e){return x.test(t)&&Array.isArray(e)&&e.length}function Tt(t,e){return x.test(t)&&Object.keys(e).length}function Vt(t,e){return C.test(t)&&0===Number(e[2])}var x=new RegExp(/^\d+$/),C=new RegExp(/^_\d+$/),Mt=[{action:"changeName",key:"name"},{action:"changeSlug",key:"slug"},{action:"setDescription",key:"description"},{action:"setSearchKeywords",key:"searchKeywords"},{action:"setKey",key:"key"},{action:"setPriceMode",key:"priceMode"}],Kt=[{action:"setAssetKey",key:"key",actionKey:"assetKey"},{action:"changeAssetName",key:"name"},{action:"setAssetDescription",key:"description"},{action:"setAssetTags",key:"tags"},{action:"setAssetSources",key:"sources"}],Ft=[{action:"setMetaTitle",key:"metaTitle"},{action:"setMetaDescription",key:"metaDescription"},{action:"setMetaKeywords",key:"metaKeywords"}],Lt=[{action:"setTaxCategory",key:"taxCategory"},{action:"transitionState",key:"state"}];function Ut(t,e,n){var i=e&&e.name;if(i)return t={action:"setAttribute",variantId:t,name:i,value:e.value},-1!==n.indexOf(i)&&delete(t=p(p({},t),{},{action:"setAttributeInAllVariants"})).variantId,t}function qt(i,t,e,n){var r;if(e)return r={action:"setAttribute",variantId:t.id,name:e.name},t=t.attributes.find(function(t){return t.name===e.name})||{},-1!==n.indexOf(e.name)&&delete(r=p(p({},r),{},{action:"setAttributeInAllVariants"})).variantId,Array.isArray(i)||"string"==typeof i?r.value=A(i,t.value):i.centAmount||i.currencyCode?r.value={centAmount:i.centAmount?A(i.centAmount):e.value.centAmount,currencyCode:i.currencyCode?A(i.currencyCode):e.value.currencyCode}:i.key?r.value=A(i.key):"object"===b(i)&&(!{}.hasOwnProperty.call(i,"_t")||"a"!==i._t?(n=Object.keys(i).reduce(function(t,e){var n=A(i[e],t[e]);return Object.assign(t,k({},e,n))},p({},t.value)),r.value=n):r=p(p({},r),{},{value:e.value})),r}function P(t){return t.id?{assetId:t.id}:{assetKey:t.key}}function R(t){var e=t.id,t=t.sku;return e?{variantId:e}:{sku:t}}function Ht(t,e,n){return Object.entries(t).find(function(t){return e=t[0],t=t[1],C.test(e)&&3===Number(t[2]);var e})?(t=e.assets.map(function(t){return t.id}),n=n.assets.map(function(t){return t.id}).filter(function(t){return void 0!==t}),n=_.default(n,t),t=G.default.apply(void 0,[t].concat(O(n))),[p({action:"changeAssetOrder",assetOrder:n.concat(t)},R(e))]):[]}function Bt(t,r,s,d){var l=[],t=t.variants;return t&&g.default(t,function(t,e){var a,o,u,c,n=N(d,e,r.variants,s.variants),i=n.oldObj,n=n.newObj;t.assets&&(C.test(e)||x.test(e))&&(e=t.assets,o=n,u=[],c=D(e,(a=i).assets,o.assets),g.default(e,function(t,e){var n,i=N(c,e,a.assets,o.assets),r=i.oldObj,i=i.newObj;zt(e,t)?u.push(p(p({action:"addAsset",asset:A(t)},R(o)),{},{position:Number(e)})):Tt(e,t)?(n=E({actions:Kt,diff:t,oldObj:r,newObj:i}).map(function(t){return"setAssetKey"===t.action?p(p(p({},t),R(a)),{},{assetId:r.id}):p(p(p({},t),R(a)),P(r))}),u.push.apply(u,O(n)),t.custom&&(n=m(t,i,r,p(p({actions:{setCustomType:"setAssetCustomType",setCustomField:"setAssetCustomField"}},R(a)),P(r))),u.push.apply(u,O(n)))):Vt(e,t)&&u.push(p(p({action:"removeAsset"},P(r)),R(a)))}),e=Ht(e,a,o),t=[].concat(O(e),u),l=l.concat(t))}),l}function $t(t,d,l,e,n){var f=3<arguments.length&&void 0!==e?e:[],p=4<arguments.length?n:void 0,y=[],e=t.variants;return e&&g.default(e,function(t,e){var i,r,a,o,n,u,c=N(p,e,d.variants,l.variants),s=c.oldObj,c=c.newObj;x.test(e)&&!Array.isArray(t)&&(e=t,u=s,u={}.hasOwnProperty.call(e,"sku")&&((e=A(e.sku))||u.sku)?{action:"setSku",variantId:u.id,sku:e||null}:null,e=t,n=s,n={}.hasOwnProperty.call(e,"key")&&((e=A(e.key))||n.key)?{action:"setProductVariantKey",variantId:n.id,key:e||null}:null,u&&y.push(u),n&&y.push(n),e=t.attributes,i=s,r=c,a=f,o=[],(u=e)&&g.default(u,function(t,e){var n;x.test(e)?Array.isArray(t)?(n=Ut(i.id,A(t),a))&&o.push(n):r.attributes&&(n=qt(t.value,i,r.attributes[e],a))&&o.push(n):C.test(e)&&(Array.isArray(t)?3===t.length&&3===t[2]||(n=Ut(i.id,A(t)||(t[0]&&t[0].name?{name:t[0].name}:void 0),a))&&o.push(n):(n=e.substring(1),r.attributes&&(e=qt(t.value,i,r.attributes[n],a))&&o.push(e)))}),n=o,y=y.concat(n))}),$.default(y,function(t,e){return t.action===e.action&&t.name===e.name&&t.variantId===e.variantId})}function _t(t,r,a,o){var u=[],t=t.variants;return t&&g.default(t,function(t,e){var n=N(o,e,r.variants,a.variants),i=n.oldObj,n=n.newObj;(C.test(e)||x.test(e))&&(e=function(t,e,n){var r=1<arguments.length&&void 0!==e?e:{},a=2<arguments.length&&void 0!==n?n:{},o=[],u=D(t,r.images,a.images,"url");return g.default(t,function(t,e){var n=N(u,e,r.images,a.images),i=n.oldObj,n=n.newObj;x.test(e)?Array.isArray(t)&&t.length?o.push({action:"addExternalImage",variantId:r.id,image:A(t)}):"object"===b(t)&&(!{}.hasOwnProperty.call(t,"url")||2!==t.url.length?!{}.hasOwnProperty.call(t,"label")||1!==t.label.length&&2!==t.label.length||o.push({action:"setImageLabel",variantId:r.id,imageUrl:i.url,label:A(t.label)}):(o.push({action:"removeImage",variantId:r.id,imageUrl:i.url}),o.push({action:"addExternalImage",variantId:r.id,image:n}))):C.test(e)&&Array.isArray(t)&&3===t.length&&(3===Number(t[2])?o.push({action:"moveImageToPosition",variantId:r.id,imageUrl:i.url,position:Number(t[1])}):0===Number(t[2])&&o.push({action:"removeImage",variantId:r.id,imageUrl:i.url}))}),o}(t.images,i,n),u=u.concat(e))}),u}function Gt(t,r,a,o,u){var c=[],s=[],d=[],t=t.variants;return t&&g.default(t,function(t,e){var n=N(o,e,r.variants,a.variants),i=n.oldObj,n=n.newObj;(C.test(e)||x.test(e))&&(t=(e=y(function(t,e,n,i){var a=1<arguments.length&&void 0!==e?e:{},o=2<arguments.length&&void 0!==n?n:{},u=3<arguments.length&&void 0!==i&&i,c=[],s=[],d=[],l=D(t,a.prices,o.prices);return g.default(t,function(t,e){var n,i=N(l,e,a.prices,o.prices),r=i.oldObj,i=i.newObj;zt(e,t)?(n=t.map(function(t){t=p({},t);return!0!==u&&delete t.discounted,t}),c.push({action:"addPrice",variantId:a.id,price:A(n)})):Tt(e,t)?(n=p({},t),!0!==u&&delete n.discounted,Object.keys(n).length&&(n=p({},i),!0!==u&&delete n.discounted,s.push({action:"changePrice",priceId:r.id,price:n}))):Vt(e,t)&&d.push({action:"removePrice",priceId:r.id})}),[c,s,d]}(t.prices,i,n,u),3))[0],i=e[1],n=e[2],c=c.concat(t),s=s.concat(i),d=d.concat(n))}),s.concat(d).concat(c)}function Zt(t,e){function n(t){return(t=Array.isArray(t.variants)?t.variants:[])[0]?t[0].id:void 0}e=n(e),t=n(t);return e&&t!==e?[{action:"changeMasterVariant",variantId:e}]:[]}function Wt(c,s){return function(r,a,o){var t=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},e=[],n=t.sameForAllAttributeNames,i=t.enableDiscounted,t=a.publish,u=a.staged,d=D(r.variants,o.variants,a.variants);return e.push(c("attributes",function(){return $t(r,o,a,n||[],d)})),e.push(c("variants",function(){return t=r,e=o,n=a,I("variants",k({},j,function(t){return p(p({},t),{},{action:"addVariant"})}))(t,e,n);var t,e,n})),e.push(Zt(o,a)),e.push(c("variants",function(){return t=r,e=o,n=a,I("variants",k({},S,function(t){return{action:"removeVariant",id:t.id}}))(t,e,n);var t,e,n})),e.push(c("base",function(){return function(t,e,n,i){return E({actions:Mt,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(r,o,a,s)})),e.push(c("meta",function(){return E({actions:Ft,diff:r,oldObj:o,newObj:a})})),e.push(c("references",function(){return l({actions:Lt,diff:r,oldObj:o,newObj:a})})),e.push(c("images",function(){return _t(r,o,a,d)})),e.push(c("pricesCustom",function(){return i=o,u=a,c=d,s=[],(t=(t=r).variants)&&g.default(t,function(t,e){var r,n=N(c,e,i.variants,u.variants),a=n.oldObj,o=n.newObj;t&&t.prices&&(C.test(e)||x.test(e))&&(r=D(t.prices,a.prices,o.prices),g.default(t.prices,function(t,e){var n=N(r,e,a.prices,o.prices),i=n.oldObj,n=n.newObj;t.custom&&(C.test(e)||x.test(e))&&(e=m(t,n,i,{actions:{setCustomType:"setProductPriceCustomType",setCustomField:"setProductPriceCustomField"},priceId:i.id}),s=s.concat(e))}))}),s;var t,i,u,c,s})),e.push(c("prices",function(){return Gt(r,o,a,d,i)})),e.push(c("categories",function(){return(t=r).categories?(n=[],i=[],g.default(t.categories,function(t){var e;Array.isArray(t)&&(e={category:t[0]},3===t.length?3!==t[2]&&(e.action="removeFromCategory",i.push(e)):1===t.length&&(e.action="addToCategory",n.push(e)))}),i.concat(n)):[];var t,n,i})),e.push(c("categories",function(){return!(n=r).categoryOrderHints||Array.isArray(n.categoryOrderHints)?[]:Object.keys(n.categoryOrderHints).map(function(t){var e=n.categoryOrderHints[t],t={action:"setCategoryOrderHint",categoryId:t};return 1===e.length?t.orderHint=e[0]:2===e.length&&0!==e[1]&&(t.orderHint=e[1]),t});var n})),e.push(c("assets",function(){return Bt(r,o,a,d)})),!0===t||!1===u?v.default(e).map(function(t){return p(p({},t),{},{staged:!1})}):v.default(e)}}function Jt(t,e){function n(t){return p(p({},t),{},{masterVariant:void 0,variants:[t.masterVariant].concat(O(t.variants||[]))})}function i(t){return t&&t.masterVariant}t=y(c(t,e),2),e=t[0],t=t[1];return[i(e)?n(e):e,i(t)?n(t):t]}var z=new RegExp(/^\d+$/),T=new RegExp(/^_\d+$/),Qt=[{action:"changeOrderState",key:"orderState"},{action:"changePaymentState",key:"paymentState"},{action:"changeShipmentState",key:"shipmentState"}];function Xt(t,e,n){var r=1<arguments.length&&void 0!==e?e:{},a=2<arguments.length&&void 0!==n?n:{},o=[],u=[],c=D(t,r.parcels,a.parcels);return g.default(t,function(t,e){var n,i=N(c,e,r.parcels,a.parcels).oldObj;n=t,z.test(e)&&Array.isArray(n)&&n.length?o.push(p({action:"addParcelToDelivery",deliveryId:r.id},A(t))):(n=t,T.test(e)&&0===Number(n[2])&&u.push({action:"removeParcelFromDelivery",parcelId:i.id}))}),[o,u]}function Yt(t,i,r,a){var o,t=t.shippingInfo;return(t=t&&t.deliveries)?(o=[],g.default(t,function(t,e){var n=N(a,e,i.shippingInfo.deliveries,r.shippingInfo.deliveries).newObj;(T.test(e)||z.test(e))&&(e=y(function(t,e){var e=1<arguments.length&&void 0!==e?e:{},n=[];return t&&0<Object.keys(t).length&&n.push({action:"setDeliveryItems",deliveryId:e.id,deliveryKey:e.key,items:e.items}),[n]}(t.items,n),1)[0],o=o.concat(e))}),o):[]}function te(n,i){return function(s,d,l){var e,t=[];return s.shippingInfo&&s.shippingInfo.deliveries&&(e=D(s.shippingInfo.deliveries,l.shippingInfo.deliveries,d.shippingInfo.deliveries)),t.push(n("base",function(){return function(t,e,n,i){return E({actions:Qt,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(s,l,d,i)})),t.push(n("deliveries",function(){return e=l,n=d,(t=(t=s).shippingInfo)?I("deliveries",k({},j,function(t){return{action:"addDelivery",items:t.items,parcels:t.parcels}}))(t,e.shippingInfo,n.shippingInfo):[];var t,e,n})),t.push(n("parcels",function(){return r=l,a=d,o=e,(t=(t=(t=s).shippingInfo)&&t.deliveries)?(u=[],c=[],t&&g.default(t,function(t,e){var n=N(o,e,r.shippingInfo.deliveries,a.shippingInfo.deliveries),i=n.oldObj,n=n.newObj;(T.test(e)||z.test(e))&&(t=(e=y(Xt(t.parcels,i,n),2))[0],i=e[1],u=u.concat(t),c=c.concat(i))}),c.concat(u)):[];var t,r,a,o,u,c})),t.push(n("items",function(){return Yt(s,l,d,e)})),t.push(v.default(n("returnInfo",function(){return e=l,n=d,(a=(t=s).returnInfo)?I("returnInfo",(k(i={},j,function(t){return t.items?[p({action:"addReturnInfo"},t)]:[]}),k(i,w,function(t,i,e){var e=a[e].items,r=void 0===e?{}:e;return 0===Object.keys(r).length?[]:Object.keys(r).reduce(function(t,e){var n=i.items[e];return r[e].shipmentState&&t.push({action:"setReturnShipmentState",returnItemId:n.id,shipmentState:n.shipmentState}),r[e].paymentState&&t.push({action:"setReturnPaymentState",returnItemId:n.id,paymentState:n.paymentState}),t},[])}),i))(t,e,n):[];var t,e,n,i,a}))),t.push(n("custom",function(){return m(s,d,l)})),v.default(t)}}var ee=[{action:"changeIsActive",key:"isActive"},{action:"changeName",key:"name"},{action:"changePredicate",key:"predicate"},{action:"changeSortOrder",key:"sortOrder"},{action:"changeValue",key:"value"},{action:"setDescription",key:"description"},{action:"setValidFrom",key:"validFrom"},{action:"setValidUntil",key:"validUntil"},{action:"setKey",key:"key"}];function ne(t){return ie.includes(t)}var ie=["setValidFrom","setValidUntil"];function s(t){var t=0<arguments.length&&void 0!==t?t:[],e=y(t.filter(function(t){return ne(t.action)}),2),n=e[0],e=e[1];return n&&e?[].concat(O(t.filter(function(t){return!ne(t.action)})),[{action:"setValidFromAndUntil",validFrom:n.validFrom,validUntil:e.validUntil}]):t}function re(r,a){return function(t,e,n){var i=[];return i.push(r("base",function(){return function(t,e,n,i){return E({actions:ee,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(t,n,e,a)})),s(v.default(i))}}var ae=[{action:"changeIsActive",key:"isActive"},{action:"setName",key:"name"},{action:"setDescription",key:"description"},{action:"setCartPredicate",key:"cartPredicate"},{action:"setMaxApplications",key:"maxApplications"},{action:"setMaxApplicationsPerCustomer",key:"maxApplicationsPerCustomer"},{action:"changeCartDiscounts",key:"cartDiscounts"},{action:"setValidFrom",key:"validFrom"},{action:"setValidUntil",key:"validUntil"},{action:"changeGroups",key:"groups"}];function oe(r,a){return function(t,e,n){var i=[];return i.push(r("base",function(){return function(t,e,n,i){return E({actions:ae,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(t,n,e,a)})),i.push(r("custom",function(){return m(t,e,n)})),s(v.default(i))}}var ue=[{action:"changeName",key:"name"},{action:"setKey",key:"key"}];function ce(r,a){return function(t,e,n){var i=[];return i.push(r("base",function(){return function(t,e,n,i){return E({actions:ue,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(t,n,e,a)})),i.push(r("custom",function(){return m(t,e,n)})),v.default(i)}}var se=[{action:"changeIsActive",key:"isActive"},{action:"changeName",key:"name"},{action:"changeCartPredicate",key:"cartPredicate"},{action:"changeSortOrder",key:"sortOrder"},{action:"changeValue",key:"value"},{action:"changeRequiresDiscountCode",key:"requiresDiscountCode"},{action:"changeTarget",key:"target"},{action:"setDescription",key:"description"},{action:"setValidFrom",key:"validFrom"},{action:"setValidUntil",key:"validUntil"},{action:"changeStackingMode",key:"stackingMode"},{action:"setKey",key:"key"}];function de(r,a){return function(t,e,n){var i=[];return i.push(r("base",function(){return function(t,e,n,i){return E({actions:se,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(t,n,e,a)})),i.push(r("custom",function(){return m(t,e,n)})),s(v.default(i))}}var le=[{action:"changeName",key:"name"},{action:"setKey",key:"key"},{action:"setDescription",key:"description"}];function fe(e,n){return function(r,a,o){var t=[];return t.push(e("base",function(){return function(t,e,n,i){return E({actions:le,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(r,o,a,n)})),t.push(e("rates",function(){return t=r,e=o,n=a,I("rates",(k(i={},j,function(t){return{action:"addTaxRate",taxRate:t}}),k(i,S,function(t){return{action:"removeTaxRate",taxRateId:t.id}}),k(i,w,function(t,e){return{action:"replaceTaxRate",taxRateId:(t.id===e.id?t:e).id,taxRate:e}}),i))(t,e,n);var t,e,n,i})),v.default(t)}}function d(t,e){return t.some(function(t){return t.country===e.country})}var pe=[{action:"changeName",key:"name"},{action:"setDescription",key:"description"},{action:"setKey",key:"key"}];function ye(e,i){return function(n,a,o){var t=[];return t.push(e("base",function(){return function(t,e,n,i){return E({actions:pe,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(n,o,a,i)})),t.push(v.default(e("locations",function(){return t=n,i=o,r=a,I("locations",(k(e={},j,function(t){return{action:"addLocation",location:t}}),k(e,S,function(t){return d(r.locations,t)?null:{action:"removeLocation",location:t}}),k(e,w,function(t,e){var n=[];return d(r.locations,t)||n.push({action:"removeLocation",location:t}),d(i.locations,e)||n.push({action:"addLocation",location:e}),n}),e))(t,i,r);var t,i,r,e}))),v.default(t)}}var he=[{action:"setKey",key:"key"},{action:"changeName",key:"name"},{action:"setLocalizedName",key:"localizedName"},{action:"setDescription",key:"description"},{action:"setLocalizedDescription",key:"localizedDescription"},{action:"changeIsDefault",key:"isDefault"},{action:"setPredicate",key:"predicate"},{action:"changeTaxCategory",key:"taxCategory"}];function me(e){return e.shippingRates?e.shippingRates.map(function(t){return{action:"addShippingRate",zone:e.zone,shippingRate:t}}):[]}function ve(c,t,e){var n;return I("zoneRates",(k(n={},j,function(t){return[{action:"addZone",zone:t.zone}].concat(O(me(t)))}),k(n,S,function(t){return{action:"removeZone",zone:t.zone}}),k(n,w,function(a,o){var u=!1,t=Object.keys(c.zoneRates).reduce(function(t,e){var n,i,r;return c.zoneRates[e].zone&&(u=!0),c.zoneRates[e].shippingRates?[].concat(O(t),O((e=c.zoneRates[e],n=a,i=o,I("shippingRates",(k(r={},j,function(t){return{action:"addShippingRate",zone:i.zone,shippingRate:t}}),k(r,S,function(t){return{action:"removeShippingRate",zone:n.zone,shippingRate:t}}),k(r,w,function(t,e){return[{action:"removeShippingRate",zone:n.zone,shippingRate:t},{action:"addShippingRate",zone:i.zone,shippingRate:e}]}),r))(e,n,i)))):t},[]);return v.default(u?[].concat(O(t),[{action:"removeZone",zone:a.zone},{action:"addZone",zone:o.zone}]):t)}),n))(c,t,e)}function ge(r,a){return function(t,e,n){var i=[];return i.push(r("base",function(){return function(t,e,n,i){return E({actions:he,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(t,n,e,a)})),i.push(v.default(r("zoneRates",function(){return ve(t,n,e)}))),i.push(r("custom",function(){return m(t,e,n)})),v.default(i)}}var V="function"==typeof WeakSet,be=Object.keys;function ke(t,e){return t===e||t!=t&&e!=e}function Oe(t){return t.constructor===Object||null==t.constructor}function Ae(t){return t&&"function"==typeof t.then}function je(t){return!(!t||!t.$$typeof)}function Se(){var e=[];return{add:function(t){e.push(t)},has:function(t){return-1!==e.indexOf(t)}}}var we=V?function(){return new WeakSet}:Se;function Ie(e){return function(t){var u=e||t;return function(t,e,n){void 0===n&&(n=we());var i=!!t&&"object"===b(t),r=!!e&&"object"===b(e);if(i||r){var a=i&&n.has(t),o=r&&n.has(e);if(a||o)return a&&o;i&&n.add(t),r&&n.add(e)}return u(t,e,n)}}}var Ee="_owner",Ne=Function.prototype.bind.call(Function.prototype.call,Object.prototype.hasOwnProperty);function De(t,e,n,i){var r=be(t),a=r.length;if(be(e).length!==a)return!1;if(a)for(var o;0<a--;){if((o=r[a])===Ee){var u=je(t),c=je(e);if((u||c)&&u!==c)return!1}if(!Ne(e,o)||!n(t[o],e[o],i))return!1}return!0}var xe="function"==typeof Map,Ce="function"==typeof Set;function o(t){var v="function"==typeof t?t(e):e;function e(t,e,n){var i,r,a,o,u,c,s,d,l,f,p,y,h,m;return t===e||(t&&e&&"object"===b(t)&&"object"===b(e)?Oe(t)&&Oe(e)?De(t,e,v,n):(i=Array.isArray(t),r=Array.isArray(e),i||r?i===r&&function(t,e,n,i){var r=t.length;if(e.length!==r)return!1;for(;0<r--;)if(!n(t[r],e[r],i))return!1;return!0}(t,e,v,n):(i=t instanceof Date,r=e instanceof Date,i||r?i===r&&ke(t.getTime(),e.getTime()):(i=t instanceof RegExp,r=e instanceof RegExp,i||r?i===r&&(m=e,(h=t).source===m.source&&h.global===m.global&&h.ignoreCase===m.ignoreCase&&h.multiline===m.multiline&&h.unicode===m.unicode&&h.sticky===m.sticky&&h.lastIndex===m.lastIndex):Ae(t)||Ae(e)?t===e:xe&&(i=t instanceof Map,r=e instanceof Map,i||r)?i===r&&(d=e,l=v,f=n,(y=(h=t).size===d.size)&&h.size&&(p={},h.forEach(function(n,i){var r,a;y&&(r=!1,a=0,d.forEach(function(t,e){r||p[a]||(r=l(i,e,f)&&l(n,t,f))&&(p[a]=!0),a++}),y=r)})),y):Ce&&(i=t instanceof Set,r=e instanceof Set,i||r)?i===r&&(a=e,o=v,u=n,(s=(m=t).size===a.size)&&m.size&&(c={},m.forEach(function(e){var n,i;s&&(n=!1,i=0,a.forEach(function(t){n||c[i]||(n=o(e,t,u))&&(c[i]=!0),i++}),s=n)})),s):De(t,e,v,n)))):t!=t&&e!=e)}return e}var Pe=o(),Re=(o(function(){return ke}),o(Ie()),o(Ie(ke)),[{action:"changeName",key:"name"},{action:"setKey",key:"key"},{action:"changeDescription",key:"description"}]);function ze(r,a,t){var o=u([void 0,null,""]);return Object.entries(t).reduce(function(t,e){var e=y(e,2),n=e[0],i=e[1];if(!o(r[n])||!o(a[n])){if(!o(r[n])&&o(a[n]))return[].concat(O(t),[i]);if(!Pe(r[n],a[n]))switch(n){case"key":return[].concat(O(t),[{action:i.action,attributeName:i.attributeName,key:r[n],newKey:a[n]}]);case"attributeConstraint":case"inputHint":return[].concat(O(t),[{action:i.action,attributeName:i.attributeName,newValue:a[n]}]);default:return[].concat(O(t),[k({action:i.action,attributeName:i.attributeName},n,a[n])])}}return t},[])}var Te=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length?arguments[1]:void 0,n=2<arguments.length?arguments[2]:void 0,t=[].concat(O(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=t.filter(function(t){return t.previous&&!t.next}),n=t.filter(function(t){return t.previous&&t.next}),t=t.filter(function(t){return!t.previous&&t.next});return[].concat(O(e.map(function(t){return{action:"removeAttributeDefinition",name:t.previous.name}})),O(v.default(n.map(function(t){return ze(t.previous,t.next,{label:{action:"changeLabel",attributeName:t.previous.name},inputTip:{action:"setInputTip",attributeName:t.previous.name},inputHint:{action:"changeInputHint",attributeName:t.previous.name},isSearchable:{action:"changeIsSearchable",attributeName:t.previous.name},attributeConstraint:{action:"changeAttributeConstraint",attributeName:t.previous.name}})}))),O(t.map(function(t){return{action:"addAttributeDefinition",attribute:t.next}})))}(t.attributeDefinitions)),O(function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=t.filter(function(t){return t.previous&&!t.next}),n=t.filter(function(t){return t.next&&t.previous}),t=t.filter(function(t){return!t.previous&&t.next});return[].concat(O(Object.values(e.reduce(function(t,e){var n=t[e.hint.attributeName]||{keys:[],attributeName:e.hint.attributeName,action:"removeEnumValues"};return p(p({},t),{},k({},e.hint.attributeName,p(p({},n),{},{keys:[].concat(O(n.keys),[e.previous.key])})))},{}))),O(v.default(n.map(function(t){var e=ze(t.previous,t.next,{key:{action:"changeEnumKey",attributeName:t.hint.attributeName}});return Pe(t.previous.label,t.next.label)?e:t.hint.isLocalized?[].concat(O(e),[{action:"changeLocalizedEnumValueLabel",attributeName:t.hint.attributeName,newValue:t.next}]):[].concat(O(e),[{action:"changePlainEnumValueLabel",attributeName:t.hint.attributeName,newValue:t.next}])}))),O(t.map(function(t){return{action:t.hint.isLocalized?"addLocalizedEnumValue":"addPlainEnumValue",attributeName:t.hint.attributeName,value:t.next}})))}(t.attributeEnumValues))),e=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];return t.length&&n.length&&(n=n.map(function(t){return t.name}),e=i.filter(function(t){return"removeAttributeDefinition"===t.action}).map(function(t){return t.name}),i=i.filter(function(t){return"addAttributeDefinition"===t.action}).map(function(t){return t.attribute.name}),t=t.map(function(t){return t.name}).filter(function(t){return!e.includes(t)}).concat(i),n.join(",")!==t.join(","))?{action:"changeAttributeOrderByName",attributeNames:n}:null}(e.attributes,n.attributes,t);return e&&t.push(e),t};function Ve(r,a){return function(t,e,n,i){return v.default([r("base",function(){return function(t,e,n,i){return t?E({diff:t,actions:Re,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString}):[]}(t,n,e,a)}),Te(i.nestedValuesChanges,n,e)])}}var Me=[{action:"changeKey",key:"key"},{action:"setName",key:"name"},{action:"setDescription",key:"description"},{action:"changeType",key:"type"},{action:"changeInitial",key:"initial"},{action:"setTransitions",key:"transitions"}];function Ke(u,c){return function(r,a,o){var e,n,t=[],i=[];return t.push(u("base",function(){return function(t,e,n,i){return E({actions:Me,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(r,o,a,c)})),i.push(u("roles",function(){return t=r,e=o,n=a,I("roles",(k(i={},j,function(t){return{action:"addRoles",roles:t}}),k(i,S,function(t){return{action:"removeRoles",roles:t}}),i))(t,e,n);var t,e,n,i})),v.default([].concat(t,O((t=y(t=i,1)[0],e=[],n=[],t.forEach(function(t){"removeRoles"===t.action&&n.push(t.roles),"addRoles"===t.action&&e.push(t.roles)}),[{action:"removeRoles",roles:n},{action:"addRoles",roles:e}].filter(function(t){return t.roles.length})))))}}var Fe=[{action:"changeKey",key:"key"},{action:"changeName",key:"name"},{action:"changeDescription",key:"description"},{action:"setAddress",key:"address"},{action:"setGeoLocation",key:"geoLocation"},{action:"setRoles",key:"roles"}];function Le(r,a){return function(t,e,n){var i=[];return i.push(r("base",function(){return function(t,e,n,i){return E({actions:Fe,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(t,n,e,a)})),i.push(r("custom",function(){return m(t,e,n)})),v.default(i)}}function Ue(t){return He.test(t)}function qe(t){return Be.test(t)}var He=new RegExp(/^\d+$/),Be=new RegExp(/^_\d+$/),$e=[{action:"changeKey",key:"key"},{action:"changeName",key:"name"},{action:"setDescription",key:"description"}];function _e(t,p,y,h){var m=[];return g.default(t,function(t,e){var a,n,i,o,u,c,s,d,r,l,f=N(h,e,p,y);Ue(e)?Array.isArray(t)?(n=A(t)).name&&m.push({action:"addFieldDefinition",fieldDefinition:n}):t.label?m.push({action:"changeLabel",label:f.newObj.label,fieldName:f.oldObj.name}):t.inputHint?m.push({action:"changeInputHint",inputHint:f.newObj.inputHint,fieldName:f.oldObj.name}):null!=t&&null!=(n=t.type)&&n.values&&m.push.apply(m,O((a=f.oldObj.name,n=f.oldObj.type.name,i=t.type,o=f.oldObj.type,u=f.newObj.type,c="Enum"===n?"addEnumValue":"addLocalizedEnumValue",s="Enum"===n?"changeEnumValueLabel":"changeLocalizedEnumValueLabel",d="Enum"===n?"changeEnumValueOrder":"changeLocalizedEnumValueOrder",n=I("values",(k(n={},j,function(t){return{fieldName:a,action:c,value:t}}),k(n,w,function(e,n){var t,i,r=[];return u.values.find(function(t){return t.key===e.key})?(t=e.key!==n.key,i=o.values.find(function(t){return t.key===n.key}),i=B.default(i.label,n.label),t&&r.push({fieldName:a,action:d,value:n}),i||r.push({fieldName:a,action:s,value:n})):r.push({fieldName:a,action:c,value:n}),r}),n)),r=[],l=[],v.default(n(i,o,u)).forEach(function(t){t.action===d?l=u.values.map(function(t){return t.key}):r.push(t)}),[].concat(r,O(0<l.length?[{fieldName:a,action:d,keys:l}]:[]))))):qe(e)&&Array.isArray(t)&&(3===t.length&&3===t[2]?m.push({action:"changeFieldDefinitionOrder",fieldNames:y.map(function(t){return t.name})}):void 0===A(t)&&t[0].name&&m.push({action:"removeFieldDefinition",fieldName:t[0].name}))}),Z.default(m,function(t){return"removeFieldDefinition"!==t.action})}function Ge(r,a){return function(t,e,n){var i=[];return i.push(r("base",function(){return function(t,e,n,i){return E({actions:$e,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(t,n,e,a)}),r("fieldDefinitions",function(){return _e(t.fieldDefinitions,n.fieldDefinitions,e.fieldDefinitions,D(t.fieldDefinitions,n.fieldDefinitions,e.fieldDefinitions,"name"))})),v.default(i)}}var Ze=[{action:"changeName",key:"name"},{action:"changeCurrencies",key:"currencies"},{action:"changeCountries",key:"countries"},{action:"changeLanguages",key:"languages"},{action:"changeMessagesConfiguration",key:"messagesConfiguration"},{action:"setShippingRateInputType",key:"shippingRateInputType"}];function We(r,a){return function(t,e,n){var i=[];return i.push(r("base",function(){return function(t,e,n,i){return E({actions:Ze,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(t,n,e,a)})),v.default(i)}}var Je=[{action:"setName",key:"name"},{action:"setLanguages",key:"languages"},{action:"setDistributionChannels",key:"distributionChannels"},{action:"setSupplyChannels",key:"supplyChannels"}];function Qe(r){return function(t,e,n){var i=[];return i.push(r("base",function(){return E({actions:Je,diff:t,oldObj:n,newObj:e})})),i.push(r("custom",function(){return m(t,e,n)})),v.default(i)}}var Xe=[{action:"changeName",key:"name"},{action:"setKey",key:"key"}];function Ye(r){return function(t,e,n){var i=[];return i.push(r("base",function(){return E({actions:Xe,diff:t,oldObj:n,newObj:e})})),i.push(r("custom",function(){return m(t,e,n)})),v.default(i)}}var tn=[{action:"changeValue",key:"value"},{action:"setDiscountedPrice",key:"discounted"},{action:"setPriceTiers",key:"tiers"},{action:"setKey",key:"key"},{action:"setValidFrom",key:"validFrom"},{action:"setValidUntil",key:"validUntil"},{action:"changeActive",key:"active"}];function en(a,o){return function(t,e,n){var i=a("base",function(){return function(t,e,n,i){return E({actions:tn,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(t,n,e,o)}),r=a("custom",function(){return m(t,e,n)});return s([].concat(O(i),O(r)))}}function nn(t,e){return t.some(function(t){return t.key===e.key})}var rn=[{action:"changeName",key:"name"},{action:"setKey",key:"key"},{action:"setDescription",key:"description"}];function an(e,i){return function(n,a,o){var t=[];return t.push(e("base",function(){return function(t,e,n,i){return E({actions:rn,diff:t,oldObj:e,newObj:n,shouldOmitEmptyString:(3<arguments.length&&void 0!==i?i:{}).shouldOmitEmptyString})}(n,o,a,i)})),t.push(v.default(e("attributes",function(){return t=n,i=o,r=a,I("attributes",(k(e={},j,function(t){return{action:"addAttribute",attribute:t}}),k(e,S,function(t){return nn(r.attributes,t)?null:{action:"removeAttribute",attribute:t}}),k(e,w,function(t,e){var n=[];return nn(r.attributes,t)||n.push({action:"removeAttribute",attribute:t}),nn(i.attributes,e)||n.push({action:"addAttribute",attribute:e}),n}),e))(t,i,r);var t,i,r,e}))),v.default(t)}}t.createSyncAttributeGroups=function(t,e){return{buildActions:n(a,an(r(t),e))}},t.createSyncCartDiscounts=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return{buildActions:n(a,de(r(t),e))}},t.createSyncCategories=function(t,e){return{buildActions:n(a,kt(r(t),e),c)}},t.createSyncChannels=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return{buildActions:n(a,Le(r(t),e))}},t.createSyncCustomerGroup=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return{buildActions:n(a,ce(r(t),e))}},t.createSyncCustomers=function(t,e){return{buildActions:n(a,Et(r(t),e),c)}},t.createSyncDiscountCodes=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return{buildActions:n(a,oe(r(t),e))}},t.createSyncInventories=function(t,e){return{buildActions:n(a,xt(r(t),e))}},t.createSyncOrders=function(t,e){return{buildActions:n(a,te(r(t),e))}},t.createSyncProductDiscounts=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return{buildActions:n(a,re(r(t),e))}},t.createSyncProductSelections=function(t){return{buildActions:n(a,Ye(r(t)),null)}},t.createSyncProductTypes=function(t,e){return{buildActions:n(a,Ve(r(t),e),null,{withHints:!0})}},t.createSyncProducts=function(t,e){return{buildActions:n(a,Wt(r(t),e),Jt)}},t.createSyncProjects=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return{buildActions:n(a,We(r(t),e))}},t.createSyncShippingMethods=function(t,e){return{buildActions:n(a,ge(r(t),e))}},t.createSyncStandalonePrices=function(t,e){return{buildActions:n(a,en(r(t),e))}},t.createSyncStates=function(t,e){return{buildActions:n(a,Ke(r(t),e))}},t.createSyncStores=function(t){return{buildActions:n(a,Qe(r(t)),null)}},t.createSyncTaxCategories=function(t,e){return{buildActions:n(a,fe(r(t),e))}},t.createSyncTypes=function(t,e){return{buildActions:n(a,Ge(r(t),e))}},t.createSyncZones=function(t,e){return{buildActions:n(a,ye(r(t),e))}},Object.defineProperty(t,"__esModule",{value:!0})});
