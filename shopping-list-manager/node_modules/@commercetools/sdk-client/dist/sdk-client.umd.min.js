!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("querystring")):"function"==typeof define&&define.amd?define(["exports","querystring"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CommercetoolsSdkClient={},e.qs)}(this,function(e,t){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var h=r(t);function i(t,e){var r,o=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,r)),o}function p(o){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach(function(e){var t,r;t=o,r=n[e=e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(n,e))})}return o}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,n,i=[],a=!0,u=!1;try{for(r=r.call(e);!(a=(o=r.next()).done)&&(i.push(o.value),!t||i.length!==t);a=!0);}catch(e){u=!0,n=e}finally{try{a||null==r.return||r.return()}finally{if(u)throw n}}return i}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var s=["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE"];function c(e,t,r){r=2<arguments.length&&void 0!==r?r:{allowedMethods:s};if(!t)throw new Error('The "'.concat(e,'" function requires a "Request" object as an argument. See https://commercetools.github.io/nodejs/sdk/Glossary.html#clientrequest'));if("string"!=typeof t.uri)throw new Error('The "'.concat(e,'" Request object requires a valid uri. See https://commercetools.github.io/nodejs/sdk/Glossary.html#clientrequest'));if(!r.allowedMethods.includes(t.method))throw new Error('The "'.concat(e,'" Request object requires a valid method. See https://commercetools.github.io/nodejs/sdk/Glossary.html#clientrequest'))}e.createClient=function(o){if(!o)throw new Error("Missing required options");if(o.middlewares&&!Array.isArray(o.middlewares))throw new Error("Middlewares should be an array");if(o.middlewares&&Array.isArray(o.middlewares)&&o.middlewares.length)return{execute:function(r){return c("exec",r),new Promise(function(e,t){(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 1===(t=t.filter(function(e){return"function"==typeof e})).length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}).apply(void 0,a(o.middlewares))(function(e,t){var r;t.error?t.reject(t.error):(r={body:t.body||{},statusCode:t.statusCode},t.headers&&(r.headers=t.headers),t.request&&(r.request=t.request),t.resolve(r))})(r,{resolve:e,reject:t,body:void 0,error:void 0})})},process:function(o,d,e){var f=this;if(c("process",o,{allowedMethods:["GET"]}),"function"!=typeof d)throw new Error('The "process" function accepts a "Function" as a second argument that returns a Promise. See https://commercetools.github.io/nodejs/sdk/api/sdkClient.html#processrequest-processfn-options');var y=p({total:Number.POSITIVE_INFINITY,accumulate:!0},e);return new Promise(function(a,u){var e=n(o.uri.split("?"),2),r=e[0],e=e[1],e=p({},h.default.parse(e)),s=p({limit:20},e),c=!1,l=y.total;(function n(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],t=s.limit<l?s.limit:l,t=h.default.stringify(p(p({},s),{},{limit:t})),e=p({sort:"id asc",withTotal:!1},e?{where:'id > "'.concat(e,'"')}:{}),e=h.default.stringify(e),e=p(p({},o),{},{uri:"".concat(r,"?").concat(e,"&").concat(t)});f.execute(e).then(function(e){var t=e.body,r=t.results,o=t.count;!o&&c?a(i||[]):Promise.resolve(d(e)).then(function(e){var t;c=!0,y.accumulate&&(t=i.concat(e||[])),l-=o,o<s.limit||!l?a(t||[]):(e=(e=r[o-1])&&e.id,n(e,t))}).catch(u)}).catch(u)})()})}};throw new Error("You need to provide at least one middleware")},Object.defineProperty(e,"__esModule",{value:!0})});
